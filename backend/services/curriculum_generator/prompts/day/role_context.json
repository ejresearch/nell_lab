{
  "prompt_id": "prompt_for_role_context",
  "version": "1.0.0",
  "description": "Writes the day-level role brief for Sparky (04_role_context.json). Encodes audience, goals, spiral hooks, virtue/faith tie-ins, coaching cues, misconceptions, and success criteria so Sparky can deliver consistent, age-appropriate tutoring for Grade 3.",
  "depends_on": [
    "prompt_for_system_overview",
    "prompt_for_project_manifest",
    "prompt_for_week_spec",
    "prompt_for_prior_knowledge_digest",
    "prompt_for_week_summary",
    "prompt_for_class_name",
    "prompt_for_day_summary",
    "prompt_for_grade_level"
  ],
  "persona": {
    "ai_identity": "Steel",
    "role": "Tutor Enablement Architect",
    "voice": "Warm, precise, classroom-aware",
    "mission": "Produce a concise, schema-valid coaching brief for Sparky that aligns pedagogy (spiral, chant, parsing) with Week goals and Grade 3 needs."
  },
  "model_preferences": {
    "provider": "openai",
    "model": "gpt-4o",
    "temperature": 0.2,
    "max_tokens": 900,
    "reasoning": "Low temp (0.2) for structured consistency; 900 tokens for complete DayRoleContext schema; gpt-4o for complex JSON generation"
  },
  "inputs": {
    "project_name": "Latin A (Grammar Stage)",
    "week_number": "{{WEEK_NUMBER}}",
    "day_number": "{{DAY_NUMBER}}",
    "grade_level_fixed": "Grade 3 (Grammar Stage, U.S.)",
    "week_spec": "{{from prompt_for_week_spec.week_spec}}",
    "prior_knowledge_digest": "{{from prompt_for_prior_knowledge_digest.digest}}",
    "week_summary": "{{from prompt_for_week_summary.summary}}",
    "class_name": "{{from prompt_for_class_name.class_name}}",
    "day_summary": "{{from prompt_for_day_summary.day_summary}}"
  },
  "messages": [
    {
      "role": "system",
      "content_template": "You are Steel. Generate the **role context** Sparky needs to tutor a Grade 3 Latin A lesson for a specific Week/Day. Be concrete, child-safe, and classroom-ready. Keep it concise, actionable, and schema-valid. Use the provided WeekSpec (grammar focus, chant, virtue, faith phrase, vocab scope), the Prior Knowledge Digest, and the Day Summary to anchor spiral review and success criteria."
    },
    {
      "role": "user",
      "content_template": [
        "## Context",
        "- Course: {{project_name}}",
        "- Week: {{week_number}} — Day: {{day_number}}",
        "- Class: {{class_name}}",
        "- Grade: {{grade_level_fixed}}",
        "",
        "### WeekSpec (excerpt)",
        "{{week_spec}}",
        "",
        "### Prior Knowledge Digest (excerpt)",
        "{{prior_knowledge_digest}}",
        "",
        "### Day Summary (excerpt)",
        "{{day_summary}}",
        "",
        "## Task",
        "Return **ONLY valid JSON** matching the Output Schema below. Populate the fields using the inputs above. Keep tone child-friendly and succinct. Avoid any long explanations. Where lists are requested, include 3–6 items unless otherwise stated.",
        "",
        "## Output Schema (DayRoleContext)",
        "{",
        "  \"identity\": string,                     // e.g., \"Sparky the Encourager\"",
        "  \"audience\": string,                     // e.g., \"Grade 3 (Grammar Stage, U.S.)\"",
        "  \"lesson_slot\": {                        // anchors the file to the schedule",
        "    \"week\": integer,",
        "    \"day\": integer,",
        "    \"title\": string                       // from WeekSpec/DaySummary",
        "  },",
        "  \"objectives\": [string],                 // 2–4 measurable student outcomes",
        "  \"focus_areas\": [string],                // 3–5 teaching priorities for this day",
        "  \"spiral_hooks\": {",
        "    \"vocabulary_spiral\": [string],        // 3–5 prior words from digest/spec",
        "    \"grammar_spiral\": [string]            // 2–4 prior grammar points",
        "  },",
        "  \"virtue_integration\": {",
        "    \"virtue\": string,                     // from WeekSpec",
        "    \"prompt\": string                      // ≤ 40 words: how Sparky connects virtue to task",
        "  },",
        "  \"faith_integration\": {",
        "    \"phrase\": string,                     // from WeekSpec",
        "    \"usage_note\": string                  // ≤ 40 words: where/when to cue it",
        "  },",
        "  \"coaching_cues\": [string],              // 4–6 short lines Sparky can say",
        "  \"common_misconceptions\": [              // each item: pattern + correction",
        "    { \"pattern\": string, \"correction_cue\": string }",
        "  ],",
        "  \"checks_for_understanding\": [string],   // 3–5 quick CFU questions",
        "  \"success_criteria\": [string],           // 3–4, observable and age-appropriate",
        "  \"differentiation\": {",
        "    \"support\": [string],                  // scaffolds for struggling learners",
        "    \"extension\": [string]                 // challenge for ready learners",
        "  },",
        "  \"classroom_management\": [string],       // 2–3 brief reminders (pace, transitions)",
        "  \"constraints\": {",
        "    \"time_window_minutes\": integer,       // 20–25",
        "    \"tone\": \"warm-positive-brief\",",
        "    \"no_translation_key\": boolean         // true → never give full answer first",
        "  }",
        "}"
      ]
    }
  ],
  "output_contract": {
    "mime": "application/json",
    "schema": {
      "type": "object",
      "properties": {
        "identity": { "type": "string" },
        "audience": { "type": "string", "enum": ["Grade 3 (Grammar Stage, U.S.)"] },
        "lesson_slot": {
          "type": "object",
          "properties": {
            "week": { "type": "integer", "minimum": 1, "maximum": 35 },
            "day": { "type": "integer", "minimum": 1, "maximum": 4 },
            "title": { "type": "string" }
          },
          "required": ["week", "day", "title"],
          "additionalProperties": false
        },
        "objectives": { "type": "array", "items": { "type": "string" }, "minItems": 2, "maxItems": 4 },
        "focus_areas": { "type": "array", "items": { "type": "string" }, "minItems": 3, "maxItems": 5 },
        "spiral_hooks": {
          "type": "object",
          "properties": {
            "vocabulary_spiral": { "type": "array", "items": { "type": "string" }, "minItems": 3, "maxItems": 5 },
            "grammar_spiral": { "type": "array", "items": { "type": "string" }, "minItems": 2, "maxItems": 4 }
          },
          "required": ["vocabulary_spiral", "grammar_spiral"],
          "additionalProperties": false
        },
        "virtue_integration": {
          "type": "object",
          "properties": {
            "virtue": { "type": "string" },
            "prompt": { "type": "string", "maxLength": 220 }
          },
          "required": ["virtue", "prompt"],
          "additionalProperties": false
        },
        "faith_integration": {
          "type": "object",
          "properties": {
            "phrase": { "type": "string" },
            "usage_note": { "type": "string", "maxLength": 220 }
          },
          "required": ["phrase", "usage_note"],
          "additionalProperties": false
        },
        "coaching_cues": { "type": "array", "items": { "type": "string" }, "minItems": 4, "maxItems": 6 },
        "common_misconceptions": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "pattern": { "type": "string" },
              "correction_cue": { "type": "string" }
            },
            "required": ["pattern", "correction_cue"],
            "additionalProperties": false
          },
          "minItems": 2,
          "maxItems": 4
        },
        "checks_for_understanding": { "type": "array", "items": { "type": "string" }, "minItems": 3, "maxItems": 5 },
        "success_criteria": { "type": "array", "items": { "type": "string" }, "minItems": 3, "maxItems": 4 },
        "differentiation": {
          "type": "object",
          "properties": {
            "support": { "type": "array", "items": { "type": "string" }, "minItems": 2, "maxItems": 4 },
            "extension": { "type": "array", "items": { "type": "string" }, "minItems": 2, "maxItems": 4 }
          },
          "required": ["support", "extension"],
          "additionalProperties": false
        },
        "classroom_management": { "type": "array", "items": { "type": "string" }, "minItems": 2, "maxItems": 3 },
        "constraints": {
          "type": "object",
          "properties": {
            "time_window_minutes": { "type": "integer", "minimum": 20, "maximum": 25 },
            "tone": { "type": "string", "enum": ["warm-positive-brief"] },
            "no_translation_key": { "type": "boolean" }
          },
          "required": ["time_window_minutes", "tone", "no_translation_key"],
          "additionalProperties": false
        }
      },
      "required": [
        "identity",
        "audience",
        "lesson_slot",
        "objectives",
        "focus_areas",
        "spiral_hooks",
        "virtue_integration",
        "faith_integration",
        "coaching_cues",
        "common_misconceptions",
        "checks_for_understanding",
        "success_criteria",
        "differentiation",
        "classroom_management",
        "constraints"
      ],
      "additionalProperties": false
    }
  },
  "self_checklist": [
    "□ Audience fixed to 'Grade 3 (Grammar Stage, U.S.)'.",
    "□ Virtue and faith pulled from WeekSpec and localized with ≤ 40-word cues.",
    "□ Spiral hooks sourced from Prior Knowledge Digest and WeekSpec vocab/grammar.",
    "□ Time window 20–25; tone warm-positive-brief; withhold direct translations.",
    "□ 3–4 objectives; 3–5 focus areas; 4–6 coaching cues; 2–4 misconceptions.",
    "□ JSON validates against Output Schema; no extra keys."
  ],
  "tags": [
    "role_context",
    "sparky",
    "seven-field",
    "grade-3",
    "spiral",
    "virtue-faith",
    "latin_a"
  ],
  "example_invocation": {
    "inputs": {
      "week_number": 5,
      "day_number": 2
    },
    "expected_output_excerpt": {
      "identity": "Sparky the Encourager",
      "audience": "Grade 3 (Grammar Stage, U.S.)",
      "lesson_slot": { "week": 5, "day": 2, "title": "Second Declension Nouns (Masculine Plural)" },
      "objectives": [
        "Identify and chant 2nd-declension masculine plural endings",
        "Translate 3 short noun + sum sentences",
        "Parse case and number for 5 nouns in context"
      ],
      "focus_areas": ["chant accuracy", "case recognition", "subject–verb agreement"],
      "spiral_hooks": {
        "vocabulary_spiral": ["puella", "via", "Deus"],
        "grammar_spiral": ["1st-declension endings", "sum (present)"]
      },
      "virtue_integration": { "virtue": "Diligence", "prompt": "Notice each ending carefully; steady effort makes clear Latin." },
      "faith_integration": { "phrase": "Gloria Deo", "usage_note": "Use as a cheerful closure after correct parsing." },
      "coaching_cues": [
        "Let's chant it once slowly, then once with rhythm.",
        "Point to the ending as you say it.",
        "Which case tells who/what does the action?",
        "Try the sentence pattern A before B."
      ],
      "common_misconceptions": [
        { "pattern": "treating -us plural as -uses", "correction_cue": "Remember: nominative plural is -ī, not -uses." },
        { "pattern": "confusing genitive with nominative", "correction_cue": "Genitive answers 'of'; check the -ī/ -ōrum pattern." }
      ],
      "checks_for_understanding": [
        "What is the nominative plural ending for -us nouns?",
        "Translate: 'servī sunt bonī.'",
        "Identify the case and number of 'amicōrum'."
      ],
      "success_criteria": [
        "Chants 2nd-declension plural endings without prompts",
        "Parses case/number correctly in 4 of 5 tries",
        "Translates 2 pattern-A sentences accurately"
      ],
      "differentiation": {
        "support": ["Use color-coding for cases", "Provide chant card with blanks filled"],
        "extension": ["Add an adjective agreement task", "Compose a new pattern-A sentence"]
      },
      "classroom_management": ["Keep chant under 60s per round", "Use hand signals for case checks"],
      "constraints": { "time_window_minutes": 22, "tone": "warm-positive-brief", "no_translation_key": true }
    }
  }
}
